package net.zonixmc.exploits.protocol;

import net.zonixmc.exploits.event.PacketReceiveEvent;
import io.netty.channel.ChannelDuplexHandler;
import io.netty.channel.ChannelHandlerContext;
import lombok.AllArgsConstructor;
import net.minecraft.server.v1_8_R3.Packet;
import org.bukkit.Bukkit;
import org.bukkit.entity.Player;

@AllArgsConstructor
public class PacketReceiver extends ChannelDuplexHandler {

    private final Player player;

    public void channelRead(ChannelHandlerContext channelHandlerContext, Object packet) throws Exception {

        PacketReceiveEvent event = new PacketReceiveEvent(player, channelHandlerContext, (Packet<?>) packet);

        Bukkit.getPluginManager().callEvent(event);

        if (!event.isCancelled())
            super.channelRead(channelHandlerContext, packet);

    }

}
